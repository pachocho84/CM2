{% set inEntity = inEntity|default(false) %}

<div class="box">
    <div class="box-heading">
        <h2>
            {{ icon('Wall') }}
            {{ 'Wall'|trans }}
        </h2>
    </div>
    <div class="box-body">
        {% for post in posts %}
            {% if not inEntity %}{% set relatedObjects = related_object(post.object, post.objectIds) %}{% endif %}
            {{ include('CMBundle:Wall:post.html.twig', {updateMore: (loop.index == 1 and updateMoreLink is defined), relatedObjects: related_object(post.object, post.objectIds)})}}
        {% endfor %}
    </div>
</div>

{% if posts.paginationData is defined and posts.paginationData.current < posts.paginationData.last %}
    <div class="well well-small load_more">
        {% if slug is not defined %}{% set slug = null %}{% endif %}
        <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({ 'page': posts.getPaginationData.next, 'slug': slug })) }}">{{ 'Load more'|trans }}</a>
    </div>
{% endif %}