{% form_theme commentForm _self %}

{% block _cm_cmbundle_comment_comment_widget %}
{% spaceless %}
    {% set attr = {placeholder: 'write a comment...'|trans, class: 'input-lg comment'} %}
    {{ block('form_widget_simple') }}
{% endspaceless %}
{% endblock  %}

<div class="box">
    <div class="box-heading">
        <h2>
            {{ icon('Wall') }}
            {{ 'Wall'|trans }}
        </h2>
    </div>
    <div class="box-body">
        {% if is_granted('ROLE_USER') %}
        	<div class="object media">
        		{{ show_img_box(app.user.img|imagine_filter('50'), {'width': 32, 'height': 32, 'offset': app.user.imgOffset,  'link': path('user_show', {'slug': app.user.slug}), 'default': 'user', 'box_attributes': {'class': 'pull-left'}}) }}
        		{{ form_start(commentForm) }}
        			{{ form_widget(commentForm.comment) }}
        		{{ form_end(commentForm) }}
        		{{ form(commentForm) }}
        	</div>
        {% endif %}
    
        {{ include('CMBundle:Wall:posts.html.twig') }}
    </div>
</div>

{% if posts.paginationData is defined and posts.paginationData.current < posts.paginationData.last %}
    <div class="well well-small load_more">
        <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({'page': posts.getPaginationData.next})) }}">{{ 'Load more'|trans }}</a>
    </div>
{% endif %}